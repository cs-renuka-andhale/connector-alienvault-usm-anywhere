{
  "type": "workflow_collections",
  "data": [
    {
      "uuid": "4bbb4587-4d78-4fdc-a41e-3fb430293449",
      "@type": "WorkflowCollection",
      "name": "Sample - AlienVault USM Anywhere - 1.1.0",
      "description": "AlienVault USM Anywhere Connector can be used to automate actions like get events, get event details, get alarm details, get alarms, get alarm labels, add alarm labels and delete alarm labels",
      "visible": true,
      "image": null,
      "recordTags": [
        "AlienVault",
        "alienvault-usm-anywhere",
        "fetch",
        "create",
        "ingest"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "uuid": "5bbfa583-1bbc-420d-98d0-8d1074e16d5e",
          "collection": "/api/3/workflow_collections/4bbb4587-4d78-4fdc-a41e-3fb430293449",
          "triggerLimit": null,
          "description": "Retrieves a list of all alarms from the AlienVault USM Anywhere server or a list of alarms, based on the input parameters you have specified.",
          "name": "Get Alarms",
          "tag": "#AlienVault USM Anywhere",
          "recordTags": [
            "AlienVault",
            "alienvault-usm-anywhere"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/03409e26-90a8-41ad-a75e-82391aaffd1a",
          "steps": [
            {
              "uuid": "03409e26-90a8-41ad-a75e-82391aaffd1a",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "313d4d88-2df1-44fb-a11b-020e72f38e61",
                "title": "AlienVault USM Anywhere: Get Alarms",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "6bd714ea-13c8-485a-9e1e-9f3e0f459572",
              "@type": "WorkflowStep",
              "name": "Get Alarms",
              "description": null,
              "status": null,
              "arguments": {
                "name": "AlienVault USM Anywhere",
                "config": "''",
                "params": {
                  "page": 1,
                  "size": 50,
                  "sort": "Time Created",
                  "sort_order": "Ascending",
                  "status": "Open",
                  "suppressed": false,
                  "rule_intent": "Environmental Awareness",
                  "rule_method": "AWS EC2 Security Group Modified",
                  "rule_strategy": "Network Access Control Modification",
                  "priority_label": "medium",
                  "timestamp_occured_gte": "2018-12-27T04:48:08.702Z",
                  "timestamp_occured_lte": "2018-12-27T04:48:08.702Z"
                },
                "version": "1.1.0",
                "connector": "alienvault-usm-anywhere",
                "operation": "get_alarms",
                "operationTitle": "Get Alarms",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "40754a78-ee01-4ae6-89fc-51fba48b3609",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Alarms",
              "sourceStep": "/api/3/workflow_steps/03409e26-90a8-41ad-a75e-82391aaffd1a",
              "targetStep": "/api/3/workflow_steps/6bd714ea-13c8-485a-9e1e-9f3e0f459572"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "ce4bc1ed-5944-4976-954c-3951b9c75d7e",
          "collection": "/api/3/workflow_collections/4bbb4587-4d78-4fdc-a41e-3fb430293449",
          "triggerLimit": null,
          "description": "Retrieves details of alarms from the AlienVault USM Anywhere server, based on the alarm ID's you have specified.",
          "name": "Get Alarm Details",
          "tag": "#AlienVault USM Anywhere",
          "recordTags": [
            "AlienVault",
            "alienvault-usm-anywhere"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/6c97b6ff-282b-4e0a-97f7-89298c9879db",
          "steps": [
            {
              "uuid": "6c97b6ff-282b-4e0a-97f7-89298c9879db",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "d85e85c6-5650-4d1f-8d1c-3b5b7340bb67",
                "title": "AlienVault USM Anywhere: Get Alarm Details",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "0b5bb33a-5f57-41ec-9361-f48c0b9beb0b",
              "@type": "WorkflowStep",
              "name": "Get Alarm Details",
              "description": null,
              "status": null,
              "arguments": {
                "name": "AlienVault USM Anywhere",
                "config": "''",
                "params": [],
                "version": "1.1.0",
                "connector": "alienvault-usm-anywhere",
                "operation": "get_alarm_details",
                "operationTitle": "Get Alarm Details",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "3d81d001-8d37-4c39-b7f0-0ad3c9ca5c52",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Alarm Details",
              "sourceStep": "/api/3/workflow_steps/6c97b6ff-282b-4e0a-97f7-89298c9879db",
              "targetStep": "/api/3/workflow_steps/0b5bb33a-5f57-41ec-9361-f48c0b9beb0b"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "a657a7de-7ce2-4aa5-8aee-67d9b5b1b934",
          "collection": "/api/3/workflow_collections/4bbb4587-4d78-4fdc-a41e-3fb430293449",
          "triggerLimit": null,
          "description": "Retrieves a list of label IDs for a specific alarm from the AlienVault USM Anywhere server, based on the alarm ID you have specified.",
          "name": "Get Alarm Labels",
          "tag": "#AlienVault USM Anywhere",
          "recordTags": [
            "AlienVault",
            "alienvault-usm-anywhere"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/eb20186f-4fca-4d58-805e-cf65c9938a03",
          "steps": [
            {
              "uuid": "eb20186f-4fca-4d58-805e-cf65c9938a03",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "dc4ce6d2-37e1-425a-a08a-c0a09820a977",
                "title": "AlienVault USM Anywhere: Get Alarm Labels",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "f33c6ed4-8bf6-403b-b965-1df785a0998c",
              "@type": "WorkflowStep",
              "name": "Get Alarm Labels",
              "description": null,
              "status": null,
              "arguments": {
                "name": "AlienVault USM Anywhere",
                "config": "''",
                "params": [],
                "version": "1.1.0",
                "connector": "alienvault-usm-anywhere",
                "operation": "get_alarm_labels",
                "operationTitle": "Get Alarm Labels",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "df25f92e-25af-45d8-834b-d8cd6e3d08ac",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Alarm Labels",
              "sourceStep": "/api/3/workflow_steps/eb20186f-4fca-4d58-805e-cf65c9938a03",
              "targetStep": "/api/3/workflow_steps/f33c6ed4-8bf6-403b-b965-1df785a0998c"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "b01ed9d1-2bcb-4a64-8b33-9b7f26b249c1",
          "collection": "/api/3/workflow_collections/4bbb4587-4d78-4fdc-a41e-3fb430293449",
          "triggerLimit": null,
          "description": "Adds a label to a specific alarm on the AlienVault USM Anywhere server, based on the alarm ID and label ID you have specified.",
          "name": "Add Alarm Label",
          "tag": "#AlienVault USM Anywhere",
          "recordTags": [
            "AlienVault",
            "alienvault-usm-anywhere"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/5ac59519-73eb-43f5-add5-79b6a1116351",
          "steps": [
            {
              "uuid": "5ac59519-73eb-43f5-add5-79b6a1116351",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "52168141-5e12-4be8-9f04-c51473feed38",
                "title": "AlienVault USM Anywhere: Add Alarm Label",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "a60b6745-2047-44d7-8efa-53bb7823a0b3",
              "@type": "WorkflowStep",
              "name": "Add Alarm Label",
              "description": null,
              "status": null,
              "arguments": {
                "name": "AlienVault USM Anywhere",
                "config": "''",
                "params": [],
                "version": "1.1.0",
                "connector": "alienvault-usm-anywhere",
                "operation": "add_alarm_label",
                "operationTitle": "Add Alarm Label",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "6b4fa6d3-7761-4e38-9517-6d0187338e97",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Add Alarm Label",
              "sourceStep": "/api/3/workflow_steps/5ac59519-73eb-43f5-add5-79b6a1116351",
              "targetStep": "/api/3/workflow_steps/a60b6745-2047-44d7-8efa-53bb7823a0b3"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "aae6e9c2-e260-4e2a-b57d-23ee011cf9ee",
          "collection": "/api/3/workflow_collections/4bbb4587-4d78-4fdc-a41e-3fb430293449",
          "triggerLimit": null,
          "description": "Deletes a label from a specific alarm on the AlienVault USM Anywhere server, based on the alarm ID and label ID you have specified.",
          "name": "Delete Alarm Label",
          "tag": "#AlienVault USM Anywhere",
          "recordTags": [
            "AlienVault",
            "alienvault-usm-anywhere"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/ae6b4a64-4341-413c-b275-1b789acdc3ce",
          "steps": [
            {
              "uuid": "ae6b4a64-4341-413c-b275-1b789acdc3ce",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "84db9656-4384-4322-b245-793197416960",
                "title": "AlienVault USM Anywhere: Delete Alarm Label",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "ac9d496f-1693-4a0e-b3af-caed80e15873",
              "@type": "WorkflowStep",
              "name": "Delete Alarm Label",
              "description": null,
              "status": null,
              "arguments": {
                "name": "AlienVault USM Anywhere",
                "config": "''",
                "params": [],
                "version": "1.1.0",
                "connector": "alienvault-usm-anywhere",
                "operation": "delete_alarm_label",
                "operationTitle": "Delete Alarm Label",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "1c0577cd-f338-474f-9d4e-0e09a239ea7b",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Delete Alarm Label",
              "sourceStep": "/api/3/workflow_steps/ae6b4a64-4341-413c-b275-1b789acdc3ce",
              "targetStep": "/api/3/workflow_steps/ac9d496f-1693-4a0e-b3af-caed80e15873"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "53dbf9d9-97de-4a4b-81dd-fe978dafa72b",
          "collection": "/api/3/workflow_collections/4bbb4587-4d78-4fdc-a41e-3fb430293449",
          "triggerLimit": null,
          "description": "Retrieves all events from the AlienVault USM Anywhere server or specific events, based on the input parameters you have specified.",
          "name": "Get Events",
          "tag": "#AlienVault USM Anywhere",
          "recordTags": [
            "AlienVault",
            "alienvault-usm-anywhere"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/bd1f682b-7406-47ba-a87a-7da253b05cac",
          "steps": [
            {
              "uuid": "bd1f682b-7406-47ba-a87a-7da253b05cac",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "50b582fd-3224-44d2-98e5-c96dfc6df9f6",
                "title": "AlienVault USM Anywhere: Get Events",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "0a0eadd3-7c6e-407a-8bfa-9034fc9e1fa2",
              "@type": "WorkflowStep",
              "name": "Get Events",
              "description": null,
              "status": null,
              "arguments": {
                "name": "AlienVault USM Anywhere",
                "config": "''",
                "params": {
                  "accountName": "account",
                  "page": 1,
                  "size": 50,
                  "sort": "Time Created",
                  "sort_order": "Ascending",
                  "suppressed": false,
                  "plugin": "plugin",
                  "sensorUUID": "308ba880-2518-44bb-9ada-07b158d11713",
                  "sourceUsername": "user@email.com",
                  "timestamp_occured_gte": "2018-12-27T04:48:08.702Z",
                  "timestamp_occured_lte": "2018-12-27T04:48:08.702Z"
                },
                "version": "1.1.0",
                "connector": "alienvault-usm-anywhere",
                "operation": "get_events",
                "operationTitle": "Get Events",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "2db0e8b8-4fa2-4693-9c5a-f706a3f256ab",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Events",
              "sourceStep": "/api/3/workflow_steps/bd1f682b-7406-47ba-a87a-7da253b05cac",
              "targetStep": "/api/3/workflow_steps/0a0eadd3-7c6e-407a-8bfa-9034fc9e1fa2"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "b22ab90a-fc49-4383-b053-1d59aac942b8",
          "collection": "/api/3/workflow_collections/4bbb4587-4d78-4fdc-a41e-3fb430293449",
          "triggerLimit": null,
          "description": "Retrieves details for a specific event from the AlienVault USM Anywhere server, based on the event ID (UUID) you have specified.",
          "name": "Get Event Details",
          "tag": "#AlienVault USM Anywhere",
          "recordTags": [
            "AlienVault",
            "alienvault-usm-anywhere"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/e33f8f8f-0d8a-4937-923e-9e96eb4019b0",
          "steps": [
            {
              "uuid": "e33f8f8f-0d8a-4937-923e-9e96eb4019b0",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "e68db8bf-14f7-4aae-916a-d6fd62139c45",
                "title": "AlienVault USM Anywhere: Get Event Details",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "18a71244-b921-46a7-88c6-06d73d6c2ba5",
              "@type": "WorkflowStep",
              "name": "Get Event Details",
              "description": null,
              "status": null,
              "arguments": {
                "name": "AlienVault USM Anywhere",
                "config": "''",
                "params": [],
                "version": "1.1.0",
                "connector": "alienvault-usm-anywhere",
                "operation": "get_event_details",
                "operationTitle": "Get Event Details",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "7cf0380e-d49a-44aa-a9a6-07ddb6bba97a",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Event Details",
              "sourceStep": "/api/3/workflow_steps/e33f8f8f-0d8a-4937-923e-9e96eb4019b0",
              "targetStep": "/api/3/workflow_steps/18a71244-b921-46a7-88c6-06d73d6c2ba5"
            }
          ]
        },
        {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":">>AlienVaultUSM > Init Macros",
              "aliasName":null,
              "tag":"#alienvault-usm-anywhere #dataingestion",
              "description":"This playbook create AlienVaultUSM macros if not exist.",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 "AlienVaultUSMMacroName",
                 "AlienVaultUSMMacroValue",
                 "overrideIfNoMatch"
              ],
              "synchronous":false,
              "lastModifyDate":1648652593,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[

              ],
              "triggerStep":"/api/3/workflow_steps/b6244aa9-6f1e-4b63-8339-7b2b6b3fc9fe",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Fetch Macro Current Value",
                    "description":null,
                    "arguments":{
                       "ASDasd":"{{vars.AlienVaultUSMMacroName}}",
                       "macroExistingRecord":"{{vars.steps.Get_AlienVaultUSM_Macros.data['hydra:member'][0]}}"
                    },
                    "status":null,
                    "top":"435",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"136da9ed-b64e-4cd0-9463-89b7cb9a7c02",
                    "id":15694
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Get AlienVaultUSM Macros",
                    "description":null,
                    "arguments":{
                       "params":{
                          "iri":"/api/wf/api/dynamic-variable/?format=json&name={{vars.AlienVaultUSMMacroName}}",
                          "body":"",
                          "method":"GET"
                       },
                       "version":"3.1.2",
                       "connector":"cyops_utilities",
                       "operation":"make_cyops_request",
                       "operationTitle":"FSR: Make FortiSOAR API Call",
                       "step_variables":[

                       ]
                    },
                    "status":null,
                    "top":"165",
                    "left":"300",
                    "stepType":"/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                    "uuid":"15837f5f-6862-4b95-95d7-966074746ecf",
                    "id":15691
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Update Marco If Required",
                    "description":null,
                    "arguments":{
                       "when":"{{(vars.overrideIfNoMatch  == true) and (vars.macroExistingRecord.value != vars.AlienVaultUSMMacroValue)}}",
                       "params":{
                          "iri":"/api/wf/api/dynamic-variable/{{ vars.macroExistingRecord.id }}/",
                          "body":"{ 'name': '{{vars.AlienVaultUSMMacroName}}'   , 'value': '{{vars.AlienVaultUSMMacroValue}}' }",
                          "method":"PUT"
                       },
                       "version":"3.0.4",
                       "connector":"cyops_utilities",
                       "operation":"make_cyops_request",
                       "operationTitle":"FSR: Make FortiSOAR API Call",
                       "step_variables":[

                       ]
                    },
                    "status":null,
                    "top":"570",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                    "uuid":"24a4cea5-6d96-4394-a0b0-ef01e70d1a66",
                    "id":15693
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"AlienVaultUSM Macro Exists",
                    "description":null,
                    "arguments":{
                       "conditions":[
                          {
                             "option":"Not Exist",
                             "step_iri":"/api/3/workflow_steps/4ec5f4f5-548d-48a8-a5e4-dc0fb3de56fd",
                             "condition":"{{ vars.steps.Get_AlienVaultUSM_Macros.data['hydra:totalItems']==0 }}",
                             "step_name":"Create AlienVaultUSM Macro"
                          },
                          {
                             "option":"Exist",
                             "default":true,
                             "step_iri":"/api/3/workflow_steps/136da9ed-b64e-4cd0-9463-89b7cb9a7c02",
                             "step_name":"Fetch Macro Current Value"
                          }
                       ]
                    },
                    "status":null,
                    "top":"300",
                    "left":"300",
                    "stepType":"/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
                    "uuid":"28e9cf3b-9c3c-4eba-9f14-65b11a52ff06",
                    "id":15692
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Create AlienVaultUSM Macro",
                    "description":null,
                    "arguments":{
                       "params":{
                          "iri":"/api/wf/api/dynamic-variable/?format=json",
                          "body":"{ 'name': '{{vars.AlienVaultUSMMacroName}}'   , 'value': '{{vars.AlienVaultUSMMacroValue}}' }",
                          "method":"POST"
                       },
                       "version":"3.0.4",
                       "connector":"cyops_utilities",
                       "operation":"make_cyops_request",
                       "operationTitle":"FSR: Make FortiSOAR API Call",
                       "step_variables":[

                       ]
                    },
                    "status":null,
                    "top":"435",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                    "uuid":"4ec5f4f5-548d-48a8-a5e4-dc0fb3de56fd",
                    "id":15689
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Start",
                    "description":null,
                    "arguments":{
                       "step_variables":{
                          "input":{
                             "params":[

                             ]
                          }
                       }
                    },
                    "status":null,
                    "top":"30",
                    "left":"300",
                    "stepType":"/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                    "uuid":"b6244aa9-6f1e-4b63-8339-7b2b6b3fc9fe",
                    "id":15690
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"AlienVaultUSM Macro Exists -> Fetch Macro Current Value",
                    "targetStep":"/api/3/workflow_steps/136da9ed-b64e-4cd0-9463-89b7cb9a7c02",
                    "sourceStep":"/api/3/workflow_steps/28e9cf3b-9c3c-4eba-9f14-65b11a52ff06",
                    "label":"Exist",
                    "isExecuted":false,
                    "uuid":"d323355c-cc3c-4f38-8d7b-c5a33a629386"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Fetch Macro Current Value -> Update Marco If Required",
                    "targetStep":"/api/3/workflow_steps/24a4cea5-6d96-4394-a0b0-ef01e70d1a66",
                    "sourceStep":"/api/3/workflow_steps/136da9ed-b64e-4cd0-9463-89b7cb9a7c02",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"b596857f-1e49-4b76-8ae4-bb4c7913e486"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Start -> Get AlienVaultUSM Macros",
                    "targetStep":"/api/3/workflow_steps/15837f5f-6862-4b95-95d7-966074746ecf",
                    "sourceStep":"/api/3/workflow_steps/b6244aa9-6f1e-4b63-8339-7b2b6b3fc9fe",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"e2331f3b-f780-4ac1-8b9f-4c1f7bdf2863"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Get AlienVaultUSM Macros -> AlienVaultUSM Macro Exists",
                    "targetStep":"/api/3/workflow_steps/28e9cf3b-9c3c-4eba-9f14-65b11a52ff06",
                    "sourceStep":"/api/3/workflow_steps/15837f5f-6862-4b95-95d7-966074746ecf",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"537d6dd6-da55-4c58-b0e5-2956f4b38bf4"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"AlienVaultUSM Macro Exists -> Create AlienVaultUSM Macro",
                    "targetStep":"/api/3/workflow_steps/4ec5f4f5-548d-48a8-a5e4-dc0fb3de56fd",
                    "sourceStep":"/api/3/workflow_steps/28e9cf3b-9c3c-4eba-9f14-65b11a52ff06",
                    "label":"Not Exist",
                    "isExecuted":false,
                    "uuid":"acf5f874-80f1-4440-9c51-2afa8d85d079"
                 }
              ],
              "priority":"/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
              "uuid":"9e8b51cf-1b7b-40df-aa9d-daa51aad90f7",
              "recordTags":[
                 "dataingestion",
                 "alienvault-usm-anywhere"
              ],
              "id":2970,
              "createUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "createDate":1648642383,
              "modifyUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "modifyDate":1648719913,
              "owners":[

              ],
              "isPrivate":false
           },
        {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"> AlienVaultUSM > Fetch",
              "aliasName":null,
              "tag":"#alienvault-usm-anywhere #fetch #dataingestion",
              "description":"This playbook fetch the open incidents.",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[

              ],
              "synchronous":false,
              "lastModifyDate":1648747299,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[

              ],
              "triggerStep":"/api/3/workflow_steps/6014bcde-0df4-4be4-998c-8637078640be",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Set Time Configuration",
                    "description":null,
                    "arguments":{
                       "curr_timestamp":"{{ arrow.utcnow().format('YYYY-MM-DDTHH:mm:ss.ssss')\n}}Z",
                       "last_pull_time":"{%if macro.AlienVaultUSMLastAlertPullTime == '0' or vars.request.env_setup %}{%if not vars.minutes or vars.minutes == ''%}0{% else %}{{((arrow.utcnow().shift(minutes=-vars.minutes)).format('YYYY-MM-DDTHH:mm:ss.ssss'))}}Z{% endif %}{% else %}{{macro.AlienVaultUSMLastAlertPullTime}}{% endif %}"
                    },
                    "status":null,
                    "top":"435",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"04e8bafe-3fe2-432d-a1f2-1be2f820e4b3",
                    "id":15677
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Configuration",
                    "description":null,
                    "arguments":{
                       "search":"",
                       "is_mssp":false,
                       "minutes":"10",
                       "page_size":"100",
                       "pages_array":"[]",
                       "tenant_mapping":"{\n  \"Super\": \"tenant1\",\n  \"usm-anywhere_customer1\": \"fortisoar_customer1\"\n}"
                    },
                    "status":null,
                    "top":"165",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"1bf00642-e024-477a-bf95-b4c7cbf298db",
                    "id":15683
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Environment Setup",
                    "description":null,
                    "arguments":{
                       "when":"{{vars.request.env_setup}}",
                       "arguments":{
                          "overrideIfNoMatch":"false",
                          "AlienVaultUSMMacroName":"AlienVaultUSMLastAlertPullTime",
                          "AlienVaultUSMMacroValue":"0"
                       },
                       "apply_async":false,
                       "step_variables":[

                       ],
                       "workflowReference":"/api/3/workflows/9e8b51cf-1b7b-40df-aa9d-daa51aad90f7"
                    },
                    "status":null,
                    "top":"300",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
                    "uuid":"4b329261-8a0d-4a1a-b98e-9e07aaf62948",
                    "id":15682
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Start",
                    "description":null,
                    "arguments":{
                       "step_variables":{
                          "input":{
                             "params":[

                             ]
                          },
                          "useMockOutput":"false",
                          "_configuration_schema":"[\n   {\n      \"title\":\"Status\",\n      \"tooltip\":\"The status of the alarm\",\n      \"description\":\"Status of the alarm based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"select\",\n      \"options\":[\n         \"Open\",\n         \"Closed\",\n         \"In Review\"\n      ],\n      \"name\":\"status\",\n      \"value\":\"Open\"\n   },\n   {\n      \"title\":\"Suppressed\",\n      \"tooltip\":\"Filter alarms by the suppressed flag\",\n      \"description\":\"Select this checkbox, i.e., set it to True, to filter alarms retrieved from the AlienVault USM Anywhere server by the suppressed flag.By default, this is set as False.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"checkbox\",\n      \"name\":\"suppressed\",\n      \"value\":false\n   },\n   {\n      \"title\":\"Rule Intent\",\n      \"tooltip\":\"The intent of the rule that triggered the alarm\",\n      \"description\":\"Intent of the rule that triggered the alarm, based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"rule_intent\",\n      \"placeholder\":\"Environmental Awareness\"\n   },\n   {\n      \"title\":\"Rule Method\",\n      \"tooltip\":\"The method of the rule that triggered the alarm\",\n      \"description\":\"Method of the rule that triggered the alarm, based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"rule_method\",\n      \"placeholder\":\"AWS EC2 Security Group Modified\"\n   },\n   {\n      \"title\":\"Rule Strategy\",\n      \"tooltip\":\"The strategy of the rule that triggered the alarm\",\n      \"description\":\"Strategy of the rule that triggered the alarm, based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"rule_strategy\",\n      \"placeholder\":\"Network Access Control Modification\"\n   },\n   {\n      \"title\":\"Priority Label\",\n      \"tooltip\":\"The priority of the alarm\",\n      \"description\":\"Priority of the alarm based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"priority_label\",\n      \"placeholder\":\"medium\"\n   },\n   {\n      \"title\":\"Alarm Sensor Sources\",\n      \"tooltip\":\"The uuid of the sensor\",\n      \"description\":\"UUID of the sensor based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"alarm_sensor_sources\"\n   }\n]"
                       }
                    },
                    "status":null,
                    "top":"30",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                    "uuid":"6014bcde-0df4-4be4-998c-8637078640be",
                    "id":15681
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Fetch Incidents",
                    "description":null,
                    "arguments":{
                       "name":"Fortinet AlienVaultUSM",
                       "config":"5c13916f-1350-4e50-b51f-1184fb54daaa",
                       "params":{
                          "page":"{{vars.item}}",
                          "size":100,
                          "sort":"Time Created",
                          "status":"{{vars.alarm_status}}",
                          "sort_order":"Ascending",
                          "suppressed":"{{vars.suppressed}}",
                          "rule_intent":"{{vars.rule_intent}}",
                          "rule_method":"{{vars.rule_method}}",
                          "rule_strategy":"{{vars.rule_strategy}}",
                          "priority_label":"{{vars.priority_label}}",
                          "alarm_sensor_sources":"{{vars.alarm_sensor_sources}}",
                          "timestamp_occured_gte":"{{vars.last_pull_time}}",
                          "timestamp_occured_lte":"{{vars.curr_timestamp}}"
                       },
                       "version":"1.1.0",
                       "for_each":{
                          "item":"{{vars.pages_array}}",
                          "parallel":false,
                          "condition":""
                       },
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_alarms",
                       "mock_result":"",
                       "operationTitle":"Get Alarms",
                       "step_variables":[

                       ]
                    },
                    "status":null,
                    "top":"839",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"6817f866-32ba-4308-bd71-35600fea4459",
                    "id":15704
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Save Result",
                    "description":null,
                    "arguments":{
                       "data":"{{vars.steps.Fetch_Incidents|json_query(\"[].data._embedded.alarms[]\")}}",
                       "event_count":"{{vars.event_count}}",
                       "current_time":"{{vars.curr_timestamp}}",
                       "AlienVaultUSMMacroName":"AlienVaultUSMLastAlertPullTime"
                    },
                    "status":null,
                    "top":"974",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"a6eafb02-241c-48a3-88ff-60255f7c11a9",
                    "id":15678
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Compute Total Pages",
                    "description":null,
                    "arguments":{
                       "__append_pages":"{%set _mp=vars.total_pages%}\n{%for n in range(_mp)%}{{vars.pages_array.append(n+1)}}{%endfor%}"
                    },
                    "status":null,
                    "top":"705",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"b6e985c2-14ed-46be-bd4d-67c28d568e3a",
                    "id":15702
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Get Alarms Count",
                    "description":null,
                    "arguments":{
                       "name":"Fortinet AlienVaultUSM",
                       "config":"5c13916f-1350-4e50-b51f-1184fb54daaa",
                       "params":{
                          "page":1,
                          "size":100,
                          "sort":"Time Created",
                          "status":"{{vars.alarm_status}}",
                          "sort_order":"Ascending",
                          "suppressed":"{{vars.suppressed}}",
                          "rule_intent":"{{vars.rule_intent}}",
                          "rule_method":"{{vars.rule_method}}",
                          "rule_strategy":"{{vars.rule_strategy}}",
                          "priority_label":"{{vars.priority_label}}",
                          "alarm_sensor_sources":"{{vars.alarm_sensor_sources}}",
                          "timestamp_occured_gte":"{{vars.last_pull_time}}",
                          "timestamp_occured_lte":"{{vars.curr_timestamp}}"
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_alarms",
                       "mock_result":"",
                       "operationTitle":"Get Alarms",
                       "step_variables":{
                          "event_count":"{{vars.result.data.page.totalElements}}",
                          "total_pages":"{{vars.result.data.page.totalPages}}"
                       }
                    },
                    "status":null,
                    "top":"570",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"f0da068e-06e4-4969-983f-074bf9110fdf",
                    "id":15701
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Configuration -> Environment Setup",
                    "targetStep":"/api/3/workflow_steps/4b329261-8a0d-4a1a-b98e-9e07aaf62948",
                    "sourceStep":"/api/3/workflow_steps/1bf00642-e024-477a-bf95-b4c7cbf298db",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"1289d7d8-b49f-4503-934b-8f12cb953cf7"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Start -> Configuration",
                    "targetStep":"/api/3/workflow_steps/1bf00642-e024-477a-bf95-b4c7cbf298db",
                    "sourceStep":"/api/3/workflow_steps/6014bcde-0df4-4be4-998c-8637078640be",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"0629f966-a951-4245-aa95-2ff6339a1da9"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Environment Setup -> Set Time Configuration",
                    "targetStep":"/api/3/workflow_steps/04e8bafe-3fe2-432d-a1f2-1be2f820e4b3",
                    "sourceStep":"/api/3/workflow_steps/4b329261-8a0d-4a1a-b98e-9e07aaf62948",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"1e0414a2-b14e-45b6-a869-d4a07e89c6a9"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Set Time Configuration -> Get Alarms Count",
                    "targetStep":"/api/3/workflow_steps/f0da068e-06e4-4969-983f-074bf9110fdf",
                    "sourceStep":"/api/3/workflow_steps/04e8bafe-3fe2-432d-a1f2-1be2f820e4b3",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"0b1bc9ea-4347-4db5-8e72-13784741416e"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Get Alarms Count -> Compute Total Pages",
                    "targetStep":"/api/3/workflow_steps/b6e985c2-14ed-46be-bd4d-67c28d568e3a",
                    "sourceStep":"/api/3/workflow_steps/f0da068e-06e4-4969-983f-074bf9110fdf",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"c3782c14-ca1e-4a57-bf19-14e3d19270dd"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Compute Total Pages -> Fetch Incidents",
                    "targetStep":"/api/3/workflow_steps/6817f866-32ba-4308-bd71-35600fea4459",
                    "sourceStep":"/api/3/workflow_steps/b6e985c2-14ed-46be-bd4d-67c28d568e3a",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"f2259367-2c53-435a-bb3c-3a601233d2b3"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Fetch Incidents -> Save Result",
                    "targetStep":"/api/3/workflow_steps/a6eafb02-241c-48a3-88ff-60255f7c11a9",
                    "sourceStep":"/api/3/workflow_steps/6817f866-32ba-4308-bd71-35600fea4459",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"b0dbae54-913c-4897-99fa-b58f89e363dd"
                 }
              ],
              "priority":null,
              "uuid":"a4c1d5c6-76a8-4a92-ac4e-4a225dbe759e",
              "recordTags":[
                 "dataingestion",
                 "fetch",
                 "alienvault-usm-anywhere"
              ],
              "id":2968,
              "createUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "createDate":1648642383,
              "modifyUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "modifyDate":1648747300,
              "owners":[

              ],
              "isPrivate":false
           },
        {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"AlienVaultUSM > Ingest",
              "aliasName":null,
              "tag":"#alienvault-usm-anywhere #ingest #dataingestion #create",
              "description":"This playbook demonstrate the list incident operation.",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[

              ],
              "synchronous":false,
              "lastModifyDate":1648745730,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[

              ],
              "triggerStep":"/api/3/workflow_steps/d38fad7c-d3fb-4ef2-aa80-b1dbf21c0150",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Configuration",
                    "description":null,
                    "arguments":{
                       "event_count":"{{ vars.result.event_count }}",
                       "tenant_name":"{{vars.result.tenant_mapping | default({})}}",
                       "alerts_status_map":"{}",
                       "alerts_severity_map":"{'low': {{'Severity'| picklist('Low') }}, 'medium': {{'Severity'| picklist('Medium') }}, 'high': {{'Severity'| picklist('High') }}}",
                       "incident_source_data":"{{ vars.result.data }}",
                       "AlienVaultUSMMacroName":"{{vars.result.AlienVaultUSMMacroName}}",
                       "alerts_closureReason_map":"{}",
                       "alerts_respSlaStatus_map":"{}",
                       "alerts_escalatedtoincident_map":"{}"
                    },
                    "status":null,
                    "top":"300",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"4d38e6d4-87d2-4830-a833-62101f0e262f",
                    "id":15699
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Update Last Alert Pull Time",
                    "description":null,
                    "arguments":{
                       "params":{
                          "macro":"{{vars.AlienVaultUSMMacroName}}",
                          "value":"{{vars.steps.List_Incident.current_time}}"
                       },
                       "version":"3.2.0",
                       "connector":"cyops_utilities",
                       "operation":"updatemacro",
                       "operationTitle":"FSR: Update Global Variables",
                       "step_variables":[

                       ]
                    },
                    "status":null,
                    "top":"570",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                    "uuid":"5e145710-8aa7-4364-9f2c-e77b955c6c55",
                    "id":15695
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"List Incident",
                    "description":null,
                    "arguments":{
                       "arguments":[

                       ],
                       "apply_async":false,
                       "step_variables":[

                       ],
                       "workflowReference":"/api/3/workflows/a4c1d5c6-76a8-4a92-ac4e-4a225dbe759e"
                    },
                    "status":null,
                    "top":"165",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
                    "uuid":"d10c4f67-e966-4b2d-b55b-52f170bd1f64",
                    "id":15697
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Start",
                    "description":null,
                    "arguments":{
                       "route":"e39f427a-307b-42b2-bbd5-96557fcc9da7",
                       "title":"AlienVaultUSM > Ingest",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[

                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.input.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[

                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[

                             ]
                          },
                          "incidents":{
                             "sort":[

                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[

                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":true,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"30",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"d38fad7c-d3fb-4ef2-aa80-b1dbf21c0150",
                    "id":15698
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Create Record",
                    "description":null,
                    "arguments":{
                       "for_each":{
                          "item":"{{vars.incident_source_data}}",
                          "__bulk":true,
                          "parallel":false,
                          "condition":"",
                          "batch_size":100
                       },
                       "resource":{
                          "url":"{{vars.item._links.self.href or None}}",
                          "name":"{{vars.item.rule_strategy}}-{{vars.item.rule_method}}",
                          "domain":"{{vars.item.attributes.domain or None}}",
                          "source":"AlienVaultUSM",
                          "status":{
                             "id":118,
                             "@id":"/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                             "icon":null,
                             "uuid":"7de816ff-7140-4ee5-bd05-93ce22002146",
                             "@type":"Picklist",
                             "color":null,
                             "display":"Open",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                             "itemValue":"Open",
                             "orderIndex":1
                          },
                          "severity":"{{vars.item.priority_label | resolveRange(vars.alerts_severity_map)}}",
                          "sourceId":"{{vars.item.uuid}}",
                          "userName":"{{vars.item.destination_username or None}}",
                          "__replace":"true",
                          "epochTime":"{{vars.item.timestamp_occured}}",
                          "sourcedata":"{{vars.item | toJSON}}",
                          "description":"<div class=\"font-size-16 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\">{{vars.item.audit_reason or 'N/A'}}</h4></div>\n{%if vars.item.highlight_fields|length > 0%}\n{%set _item_data={}%}{%for entry in vars.item.highlight_fields%}{%set _tmp=_item_data.update({entry:vars.item[entry] or 'N/A'})%}{%endfor%}\n{{_item_data | json2html(row_fields=[], template=\"Stylized with row selection\", display=\"Vertical\", styling=false, table_style={})}}{%endif%}",
                          "targetAsset":"{{vars.item.destination_asset_id or None}}",
                          "ackSlaStatus":{
                             "id":308,
                             "@id":"/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                             "icon":null,
                             "uuid":"72979f64-e8b9-4888-a965-957e0ec24818",
                             "@type":"Picklist",
                             "color":"#808080",
                             "display":"Awaiting Action",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                             "itemValue":"Awaiting Action",
                             "orderIndex":2
                          },
                          "computerName":"{{vars.item.destination_asset_id or None}}",
                          "closureReason":{
                             "id":251,
                             "@id":"/api/3/picklists/8590c81e-3307-4645-97f5-c3e1bec4e05a",
                             "icon":null,
                             "uuid":"8590c81e-3307-4645-97f5-c3e1bec4e05a",
                             "@type":"Picklist",
                             "color":null,
                             "display":"Tasks Completed",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                             "itemValue":"Tasks Completed",
                             "orderIndex":0
                          },
                          "destinationIp":"{{vars.item.attributes.destIpAddr or None}}",
                          "mitreattackid":"{{vars.item.rule_attack_id or None}}",
                          "respSlaStatus":{
                             "id":308,
                             "@id":"/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                             "icon":null,
                             "uuid":"72979f64-e8b9-4888-a965-957e0ec24818",
                             "@type":"Picklist",
                             "color":"#808080",
                             "display":"Awaiting Action",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                             "itemValue":"Awaiting Action",
                             "orderIndex":2
                          },
                          "mitreTechnique":"{{vars.item.rule_attack_technique or None}}",
                          "priorityWeight":1,
                          "alertDetectionDate":"{{vars.item.timestamp_received or None}}",
                          "escalatedtoincident":{
                             "id":31,
                             "@id":"/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                             "icon":null,
                             "uuid":"2128a09c-153d-4db3-985d-de6be33deae5",
                             "@type":"Picklist",
                             "color":"#808080",
                             "display":"No",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                             "itemValue":"No",
                             "orderIndex":1
                          },
                          "alertRemainingAckSLA":0
                       },
                       "_showJson":false,
                       "operation":"Overwrite",
                       "collection":"/api/3/upsert/alerts",
                       "__recommend":[

                       ],
                       "fieldOperation":{
                          "recordTags":"Overwrite"
                       },
                       "step_variables":[

                       ]
                    },
                    "status":null,
                    "top":"435",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
                    "uuid":"fae754d3-f42d-407c-bdb7-1231e552bf3e",
                    "id":15696
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Start -> List Incident",
                    "targetStep":"/api/3/workflow_steps/d10c4f67-e966-4b2d-b55b-52f170bd1f64",
                    "sourceStep":"/api/3/workflow_steps/d38fad7c-d3fb-4ef2-aa80-b1dbf21c0150",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"25c33e5e-0481-425c-ad4e-893499e67d24"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Create Record -> Update Last Alert Pull Time",
                    "targetStep":"/api/3/workflow_steps/5e145710-8aa7-4364-9f2c-e77b955c6c55",
                    "sourceStep":"/api/3/workflow_steps/fae754d3-f42d-407c-bdb7-1231e552bf3e",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"57edefbc-9a83-4855-8b1e-578fc811d03e"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Config -> Create Alert1",
                    "targetStep":"/api/3/workflow_steps/fae754d3-f42d-407c-bdb7-1231e552bf3e",
                    "sourceStep":"/api/3/workflow_steps/4d38e6d4-87d2-4830-a833-62101f0e262f",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"920266f8-5a4b-486b-a62e-4da0f68dab30"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"List Incident -> Config",
                    "targetStep":"/api/3/workflow_steps/4d38e6d4-87d2-4830-a833-62101f0e262f",
                    "sourceStep":"/api/3/workflow_steps/d10c4f67-e966-4b2d-b55b-52f170bd1f64",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"2c918a9f-e807-4daa-8fd3-0a92872ead7b"
                 }
              ],
              "priority":null,
              "uuid":"aa96e943-bacd-45e7-94c8-168eb06d77b1",
              "recordTags":[
                 "dataingestion",
                 "create",
                 "ingest",
                 "alienvault-usm-anywhere"
              ],
              "id":2971,
              "createUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "createDate":1648642383,
              "modifyUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "modifyDate":1648745730,
              "owners":[

              ],
              "isPrivate":false
           }
      ]
    }
  ]
}